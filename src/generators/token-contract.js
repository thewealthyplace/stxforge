function generateTokenContract(config) {
  const { name, symbol, decimals, supply, mintable, burnable, capped, maxSupply, contractName } = config;

  const lines = [];

  lines.push(`;; ${name} â€” SIP-010 Fungible Token`);
  lines.push(`;; Generated by stxforge`);
  lines.push(`;; Standard: SIP-010`);
  lines.push('');
  lines.push("(impl-trait 'SP3FBR2AGK5H9QBDH3EEN6DF8EK8JY7RX8QJ5SVTE.sip-010-trait-ft-standard.sip-010-trait)");
  lines.push('');

  if (capped) {
    lines.push(`(define-fungible-token ${contractName} u${maxSupply})`);
  } else {
    lines.push(`(define-fungible-token ${contractName})`);
  }

  lines.push('');
  lines.push(';; -- Constants --');
  lines.push('');
  lines.push(`(define-constant CONTRACT-OWNER tx-sender)`);
  lines.push(`(define-constant ERR-OWNER-ONLY (err u100))`);
  lines.push(`(define-constant ERR-NOT-TOKEN-OWNER (err u101))`);
  lines.push(`(define-constant ERR-INSUFFICIENT-BALANCE (err u102))`);
  lines.push(`(define-constant ERR-INVALID-AMOUNT (err u103))`);
  lines.push(`(define-constant ERR-INVALID-RECIPIENT (err u104))`);

  if (capped) {
    lines.push(`(define-constant ERR-MAX-SUPPLY-REACHED (err u105))`);
    lines.push(`(define-constant MAX-SUPPLY u${maxSupply})`);
  }

  lines.push('');
  lines.push(';; -- Data Vars --');
  lines.push('');
  lines.push(`(define-data-var token-name (string-ascii 32) "${name}")`);
  lines.push(`(define-data-var token-symbol (string-ascii 10) "${symbol}")`);
  lines.push(`(define-data-var token-decimals uint u${decimals})`);
  lines.push(`(define-data-var token-uri (optional (string-utf8 256)) none)`);

  if (mintable) {
    lines.push(`(define-data-var minter principal CONTRACT-OWNER)`);
  }

  lines.push('');
  lines.push(';; -- SIP-010 Read-Only Functions --');
  lines.push('');
  lines.push('(define-read-only (get-name)');
  lines.push('  (ok (var-get token-name)))');
  lines.push('');
  lines.push('(define-read-only (get-symbol)');
  lines.push('  (ok (var-get token-symbol)))');
  lines.push('');
  lines.push('(define-read-only (get-decimals)');
  lines.push('  (ok (var-get token-decimals)))');
  lines.push('');
  lines.push(`(define-read-only (get-balance (account principal))`);
  lines.push(`  (ok (ft-get-balance ${contractName} account)))`);
  lines.push('');
  lines.push('(define-read-only (get-total-supply)');
  lines.push(`  (ok (ft-get-supply ${contractName})))`);
  lines.push('');
  lines.push('(define-read-only (get-token-uri)');
  lines.push('  (ok (var-get token-uri)))');
  lines.push('');
  lines.push(';; -- SIP-010 Transfer --');
  lines.push('');
  lines.push('(define-public (transfer (amount uint) (sender principal) (recipient principal) (memo (optional (buff 34))))');
  lines.push('  (begin');
  lines.push('    (asserts! (is-eq tx-sender sender) ERR-NOT-TOKEN-OWNER)');
  lines.push('    (asserts! (> amount u0) ERR-INVALID-AMOUNT)');
  lines.push('    (asserts! (not (is-eq sender recipient)) ERR-INVALID-RECIPIENT)');
  lines.push(`    (try! (ft-transfer? ${contractName} amount sender recipient))`);
  lines.push('    (match memo m (print m) 0x)');
  lines.push('    (ok true)))');
  lines.push('');
  lines.push(';; -- Admin Functions --');
  lines.push('');
  lines.push('(define-public (set-token-uri (new-uri (optional (string-utf8 256))))');
  lines.push('  (begin');
  lines.push('    (asserts! (is-eq tx-sender CONTRACT-OWNER) ERR-OWNER-ONLY)');
  lines.push('    (var-set token-uri new-uri)');
  lines.push('    (ok true)))');

  if (mintable) {
    lines.push('');
    lines.push(';; -- Mint --');
    lines.push('');
    lines.push('(define-public (mint (amount uint) (recipient principal))');
    lines.push('  (begin');
    lines.push('    (asserts! (is-eq tx-sender (var-get minter)) ERR-OWNER-ONLY)');
    lines.push('    (asserts! (> amount u0) ERR-INVALID-AMOUNT)');

    if (capped) {
      lines.push(`    (asserts! (<= (+ (ft-get-supply ${contractName}) amount) MAX-SUPPLY) ERR-MAX-SUPPLY-REACHED)`);
    }

    lines.push(`    (ft-mint? ${contractName} amount recipient)))`);
    lines.push('');
    lines.push('(define-public (set-minter (new-minter principal))');
    lines.push('  (begin');
    lines.push('    (asserts! (is-eq tx-sender CONTRACT-OWNER) ERR-OWNER-ONLY)');
    lines.push('    (var-set minter new-minter)');
    lines.push('    (ok true)))');
  }

  if (burnable) {
    lines.push('');
    lines.push(';; -- Burn --');
    lines.push('');
    lines.push('(define-public (burn (amount uint) (owner principal))');
    lines.push('  (begin');
    lines.push('    (asserts! (is-eq tx-sender owner) ERR-NOT-TOKEN-OWNER)');
    lines.push('    (asserts! (> amount u0) ERR-INVALID-AMOUNT)');
    lines.push(`    (ft-burn? ${contractName} amount owner)))`);
  }

  lines.push('');
  lines.push(';; -- Initialization --');
  lines.push('');
  lines.push('(begin');
  lines.push(`  (try! (ft-mint? ${contractName} u${supply} CONTRACT-OWNER)))`);

  return lines.join('\n');
}

module.exports = { generateTokenContract };
